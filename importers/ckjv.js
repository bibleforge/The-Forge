"use strict";

var auto_convert,
    config = require("../config.js").config,
    create_verse_tables = require("../create_verse_tables.js").run,
    download_file = require("../helpers/download.js").download,
    forge = require("../helpers/forge.js").forge,
    fs = require("fs"),
    language_dir = process.cwd() + "/language_tools/chinese/",
    random_numbers = require("../helpers/random.js").random_numbers;

auto_convert = require(language_dir + "0-auto_convert.js").run;

function copy_file(old_path, new_path)
{
    fs.writeFileSync(new_path, fs.readFileSync(old_path));
}

function psalm_has_title(c)
{
    return !(c <= 2 || c === 10 || c === 33 || c === 43 || c === 71 || c === 91 || (c >= 93 && c <= 97) || c === 99 || (c >= 104 && c <= 107) || (c >= 111 && c <= 119) || (c >= 135 && c <= 137) || c >= 146);
}

function split_into_text_verse(data)
{
    var book = 0,
        last_book,
        res = [];
    
    data.forEach(function (row)
    {
        /// Format: BC:V TEXT
        /// Example: 
        ///     创1:1 起初，　上帝创造天地。
        ///     創1:3 　上帝說：「要有光」，就有了光。 (NOTE: Sometimes there is intentional whitespace before a word/line).
        var split = row.match(/(\D+)([\d]+):([\d]+) *(.*)/),
            title;
        
        if (split[1] !== last_book) {
            last_book = split[1];
            book += 1;
        }
        
        /// Get Psalm titles.
        if (book === 19 && psalm_has_title(Number(split[2])) && Number(split[3]) === 1) {
            ///NOTE: Psalm titles are placed on verse 1 inside Chinese parentheses (（）).
            ///      But because notes can be in parentheses too, check to make sure we don't match that with a negative lookahead.
            ///      The two dots (..) are to get the last two characters not matched because of the negative lookahead.
            title = split[4].match(/^（((.(?![^\u0020-\u00ff]）))+..)/);
            
            res[res.length] = {
                b: book,
                c: split[2],
                v: 0,
                text: title[1]
            };
            
            /// Remove the title from the verse.
            split[4] = split[4].substr(title[1].length + 2)
        }
        
        res[res.length] = {
            b: book,
            c: split[2],
            v: split[3],
            text: split[4]
        };
    });
    
    return res;
}

function get_data(data)
{
    ///NOTE: There is some junk data before "profiles" at the beginning of the file, so we use ".*" to get rid of it.
    ///NOTE: Applying various (temporary) fixes.
    return JSON.parse(data
        .replace(/Ｈ/g, "H")
        .replace(/fromthe/g, "from the")
        
        /// Simp
        .replace("<HY>愿他们的腰时常弯下（and bow down their back alway）。」", "<HY>愿他们的腰时常弯下（and bow down their back alway）</HY>。」")
        .replace("滑土（slime）和沥青（pitch）", "<HY>滑土（slime）</HY><HY>和沥青（pitch）</HY>")
        .replace("<HY>诸天之上（in the heavens）<HY></HY>，大地之下（in the earth）</HY>", "<HY>诸天之上（in the heavens）</HY><HY>，大地之下（in the earth）</HY>")
        .replace("，厌恶（hate）", "，<HY>厌恶（hate）</HY>")
        .replace("　上帝（God）警戒（warned）", "<HY>　上帝（God）</HY><HY>警戒（warned）</HY>")
        .replace("<HY>我们（our）<HY></HY>看为（think）</HY>", "<HY>我们（our）</HY><HY>看为（think）</HY>")
        .replace("「看哪（Behold）", "「<HY>看哪（Behold）</HY>")
        .replace("可恶（wicked）", "<HY>可恶（wicked）</HY>")
        .replace("只走王的大道（king's high way）", "只走<HY>王的大道（king's high way）</HY>")
        .replace("你的军长彷佛成群的蚱蜢（grasshoppers）", "你的军长彷佛成群的<HY>蚱蜢（grasshoppers）</HY>")
        .replace("众人听见这些（these）", "众人听见<HY>这些（these）</HY>")
        .replace("。不料（behold），", "。<HY>不料（behold）</HY>，")
        .replace("<HY>并有一人必然来到（and one shall certainly come），并且泛滥经过（and overflow, and pass through）<HY>", "<HY>并有一人必然来到（and one shall certainly come）</HY>，<HY>并且泛滥经过（and overflow, and pass through）</HY>")
        .replace("<HY>正如经上所写的：「（as it is written）</HY>", "<HY>正如经上所写的：（as it is written）</HY>「")
        .replace("众女daughters）", "众女（daughters）") /// 结26:8
        .replace("<HY>已经（have）</HY> known", "<HY>已经（have known）</HY>认识") /// 约一2:14
        
        /// Trad
        .replace("<HY>願他們的腰時常彎下（and bow down their back alway）。」", "<HY>願他們的腰時常彎下（and bow down their back alway）</HY>。 」")
        .replace("滑土（slime）和瀝青（pitch）", "<HY>滑土（slime）</HY><HY>和瀝青（pitch）</HY>")
        .replace("<HY>諸天之上（in the heavens）<HY></HY>，大地之下（in the earth）</HY>", "<HY>諸天之上（in the heavens ）</HY><HY>，大地之下（in the earth）</HY>")
        .replace("，厭惡（hate）", "，<HY>厭惡（hate）</HY>")
        .replace("　上帝（God）警戒（warned）", "<HY>　上帝（God）</HY><HY>警戒（warned）</HY>")
        .replace("<HY>我們（our）<HY></HY>看為（think）</HY>", "<HY>我們（our）</HY><HY>看為（think）< /HY>")
        .replace("「看哪（Behold）", "「<HY>看哪（Behold）</HY>")
        .replace("可惡（wicked）", "<HY>可惡（wicked）</HY>")
        .replace("只走王的大道（king's high way）", "只走<HY>王的大道（king's high way）</HY>")
        .replace("你的軍長彷彿成群的蚱蜢（grasshoppers）", "你的軍長彷彿成群的<HY>蚱蜢（grasshoppers）</HY>")
        .replace("眾人聽見這些（these）", "眾人聽見<HY>這些（these）</HY>")
        .replace("。不料（behold），", "。<HY>不料（behold）</HY>，")
        .replace("<HY>並有一人必然來到（and one shall certainly come），並且氾濫經過（and overflow, and pass through）<HY>", "<HY>並有一人必然來到（and one shall certainly come）</HY>，<HY>並且氾濫經過（and overflow, and pass through）</HY>")
        .replace("<HY>正如經上所寫的：「（as it is written）</HY>", "<HY>正如經上所寫的：（as it is written）</HY>「")
        .replace("眾女daughters）", "眾女（daughters）")
        .replace("<HY>已經（have）</HY> known", "<HY>已經（have known）</HY>認識")
        
        .replace(/(<HY>[^<]*<)[^/]/g, "$1/H")
        .replace(/.*profiles\s*=\s*new\s*Array\s*\(\s*/, "[").replace(/^\);$/m, "]").replace("loaded_ckjv = true;", "").trim());
}

function compile_arr(arr)
{
    var prefix = "",
        res = [],
        split_pos;
    
    arr.forEach(function (phrase, i)
    {
        if (typeof phrase === "string") {
            if (i === 0) {
                prefix = phrase;
            } else {
                /// Find where the first right sided puncutation occurs.
                ///NOTE: If none is found, null is returned, which is then converted to {index: -1}.
                ///NOTE: Since "（" can occor before English characters(which should not be right-sided), check for non-English (i.e., punctaution) or the end of the string.
                split_pos = (/(?:<HY>|\u3000|「|『|（(?:[^a-zA-Z]|$))/.exec(phrase) || {index: -1}).index;
                if (split_pos > -1) {
                    /// Put the first part of the string on the last word (if any).
                    res[res.length - 1] += phrase.substr(0, split_pos);
                    /// Save the rest for the next word.
                    prefix = phrase.substr(split_pos);
                } else {
                    res[res.length - 1] += phrase;
                }
            }
        } else {
            phrase.forEach(function (word)
            {
                res[res.length] = prefix + word;
                prefix = "";
            });
        }
    });
    
    if (prefix) {
        console.log(arr);
        console.log(res);
        console.log(prefix);
        throw "Something when wrong";
    }
    
    return res;
}

function import_text(context, data_file, name, lang, segment, word_len, notes_len, callback)
{
    var data = split_into_text_verse(get_data(data_file)),
        db   = require("../helpers/db.js").db,
        obj = {},
        /// This is a temporary solution.
        paragraphs_1611 = {1001001:1,1001006:1,1001009:1,1001014:1,1001024:1,1001026:1,1001029:1,1002001:1,1002004:1,1002008:1,1002018:1,1003001:1,1003022:1,1004001:1,1004009:1,1004016:1,1004019:1,1004025:1,1005001:1,1005003:1,1005009:1,1005012:1,1005015:1,1005018:1,1005021:1,1005028:1,1006001:1,1006005:1,1006009:1,1006014:1,1007001:1,1007007:1,1007011:1,1008001:1,1008006:1,1008013:1,1008015:1,1008020:1,1009001:1,1009008:1,1009018:1,1009028:1,1010001:1,1010006:1,1010015:1,1010021:1,1011001:1,1011010:1,1011027:1,1012001:1,1012006:1,1012010:1,1012014:1,1013001:1,1013005:1,1013014:1,1014001:1,1014013:1,1014017:1,1015001:1,1016001:1,1016004:1,1016007:1,1016015:1,1017001:1,1017009:1,1017015:1,1017023:1,1018001:1,1018009:1,1018016:1,1018023:1,1019001:1,1019004:1,1019012:1,1019015:1,1019017:1,1019023:1,1019026:1,1019027:1,1019029:1,1019030:1,1020001:1,1020017:1,1021001:1,1021006:1,1021009:1,1021012:1,1021022:1,1021033:1,1022001:1,1022003:1,1022015:1,1022020:1,1023001:1,1023003:1,1023017:1,1024001:1,1024007:1,1024010:1,1024015:1,1024029:1,1024032:1,1024061:1,1025001:1,1025005:1,1025011:1,1025012:1,1025019:1,1025024:1,1025029:1,1026001:1,1026006:1,1026017:1,1026026:1,1026034:1,1027001:1,1027006:1,1027018:1,1027030:1,1027041:1,1028001:1,1028006:1,1028010:1,1028016:1,1029001:1,1029009:1,1029015:1,1029021:1,1029031:1,1030001:1,1030014:1,1030022:1,1030025:1,1030037:1,1031001:1,1031017:1,1031025:1,1031036:1,1031043:1,1032001:1,1032006:1,1032009:1,1032013:1,1032024:1,1033001:1,1033016:1,1033018:1,1034001:1,1034006:1,1034020:1,1034025:1,1035001:1,1035006:1,1035009:1,1035016:1,1035021:1,1035027:1,1036001:1,1036009:1,1036014:1,1036015:1,1036017:1,1036018:1,1036020:1,1036031:1,1037001:1,1037005:1,1037009:1,1037012:1,1037015:1,1037023:1,1037029:1,1038001:1,1038012:1,1038024:1,1038027:1,1039001:1,1039007:1,1039021:1,1040001:1,1040005:1,1040020:1,1041001:1,1041009:1,1041014:1,1041025:1,1041037:1,1041046:1,1041053:1,1042001:1,1042003:1,1042021:1,1042025:1,1042029:1,1042035:1,1043001:1,1043015:1,1043026:1,1044001:1,1044006:1,1044014:1,1044018:1,1045001:1,1045016:1,1045025:1,1046001:1,1046008:1,1046010:1,1046011:1,1046012:1,1046013:1,1046014:1,1046016:1,1046017:1,1046020:1,1046021:1,1046023:1,1046024:1,1046028:1,1047001:1,1047011:1,1047013:1,1047027:1,1048001:1,1048005:1,1048015:1,1049001:1,1049003:1,1049005:1,1049008:1,1049013:1,1049014:1,1049016:1,1049019:1,1049020:1,1049021:1,1049022:1,1049027:1,1049028:1,1050001:1,1050007:1,1050014:1,1050015:1,1050022:1,2001001:1,2001007:1,2001015:1,2002001:1,2002005:1,2002011:1,2002023:1,2003001:1,2003007:1,2003011:1,2003019:1,2004001:1,2004006:1,2004010:1,2004018:1,2004024:1,2004027:1,2004029:1,2005001:1,2005010:1,2005015:1,2005020:1,2006001:1,2006009:1,2006014:1,2006016:1,2006021:1,2006028:1,2007001:1,2007008:1,2007010:1,2007014:1,2007019:1,2008001:1,2008005:1,2008008:1,2008016:1,2008020:1,2008025:1,2009001:1,2009008:1,2009013:1,2009022:1,2009027:1,2010001:1,2010012:1,2010016:1,2010021:1,2010024:1,2010027:1,2011001:1,2012001:1,2012003:1,2012011:1,2012018:1,2012021:1,2012029:1,2012031:1,2012037:1,2012040:1,2012043:1,2013001:1,2013003:1,2013005:1,2013008:1,2013011:1,2013014:1,2013017:1,2013020:1,2014001:1,2014005:1,2014010:1,2014013:1,2014015:1,2014019:1,2014023:1,2014026:1,2015001:1,2015020:1,2015023:1,2015027:1,2016001:1,2016004:1,2016009:1,2016011:1,2016016:1,2016022:1,2016027:1,2016032:1,2017001:1,2017008:1,2018001:1,2018007:1,2018013:1,2018027:1,2019001:1,2019007:1,2019010:1,2019014:1,2019016:1,2020001:1,2020012:1,2020018:1,2020022:1,2020024:1,2021001:1,2021007:1,2021012:1,2021015:1,2021016:1,2021017:1,2021018:1,2021020:1,2021022:1,2021026:1,2021028:1,2021033:1,2021035:1,2022001:1,2022002:1,2022005:1,2022006:1,2022007:1,2022014:1,2022016:1,2022018:1,2022019:1,2022020:1,2022021:1,2022022:1,2022025:1,2022028:1,2022029:1,2022031:1,2023001:1,2023002:1,2023003:1,2023004:1,2023008:1,2023009:1,2023014:1,2023020:1,2023026:1,2024001:1,2024003:1,2024009:1,2024012:1,2025001:1,2025010:1,2025023:1,2025031:1,2026001:1,2026007:1,2026015:1,2026026:1,2026031:1,2026033:1,2027001:1,2027009:1,2027012:1,2027016:1,2027018:1,2027020:1,2028001:1,2028006:1,2028013:1,2028015:1,2028022:1,2028026:1,2028030:1,2028031:1,2028033:1,2028036:1,2028039:1,2028040:1,2029001:1,2029015:1,2029019:1,2029029:1,2029031:1,2029038:1,2029045:1,2030001:1,2030011:1,2030017:1,2030022:1,2030034:1,2031001:1,2031012:1,2031018:1,2032001:1,2032007:1,2032015:1,2032019:1,2032025:1,2032030:1,2033001:1,2033004:1,2033012:1,2034001:1,2034004:1,2034010:1,2034018:1,2034021:1,2034022:1,2034023:1,2034029:1,2035001:1,2035004:1,2035020:1,2035030:1,2036001:1,2036005:1,2036008:1,2036014:1,2036020:1,2036031:1,2036035:1,2036037:1,2037001:1,2037006:1,2037010:1,2037017:1,2037025:1,2037029:1,2038001:1,2038008:1,2038009:1,2038021:1,2039001:1,2039006:1,2039008:1,2039022:1,2039027:1,2039030:1,2039032:1,2039033:1,2040001:1,2040017:1,2040020:1,2040022:1,2040024:1,2040026:1,2040028:1,2040030:1,2040034:1,3001001:1,3001010:1,3001014:1,3002001:1,3002004:1,3002005:1,3002007:1,3002012:1,3003001:1,3003006:1,3003012:1,3004001:1,3004013:1,3004022:1,3004027:1,3005001:1,3005011:1,3005014:1,3005017:1,3006001:1,3006008:1,3006014:1,3006019:1,3006024:1,3007001:1,3007022:1,3007028:1,3007035:1,3008001:1,3008018:1,3008022:1,3008031:1,3009001:1,3009005:1,3009008:1,3009015:1,3010001:1,3010008:1,3010012:1,3010016:1,3011001:1,3011009:1,3011013:1,3011029:1,3012001:1,3013001:1,3013009:1,3013018:1,3013024:1,3013029:1,3013038:1,3013047:1,3014001:1,3014033:1,3015001:1,3015019:1,3016001:1,3016015:1,3016020:1,3016029:1,3017001:1,3017008:1,3017010:1,3018001:1,3018006:1,3019001:1,3019003:1,3019004:1,3019005:1,3019009:1,3019011:1,3019012:1,3019013:1,3019014:1,3019015:1,3019016:1,3019017:1,3019018:1,3019019:1,3019020:1,3019023:1,3019026:1,3019029:1,3019030:1,3019031:1,3019032:1,3019033:1,3019035:1,3020001:1,3020006:1,3020007:1,3020009:1,3020010:1,3020022:1,3020027:1,3021001:1,3021009:1,3021016:1,3022001:1,3022014:1,3022017:1,3022026:1,3023001:1,3023004:1,3023009:1,3023015:1,3023022:1,3023023:1,3023026:1,3023033:1,3024001:1,3024005:1,3024010:1,3024017:1,3024023:1,3025001:1,3025008:1,3025018:1,3025023:1,3025025:1,3025035:1,3025039:1,3025047:1,3026001:1,3026002:1,3026003:1,3026014:1,3026021:1,3027001:1,3027014:1,3027026:1,4001001:1,4001005:1,4001017:1,4001022:1,4001024:1,4001026:1,4001028:1,4001030:1,4001032:1,4001034:1,4001036:1,4001038:1,4001040:1,4001042:1,4001047:1,4002001:1,4002010:1,4002017:1,4002018:1,4002025:1,4002029:1,4002032:1,4003001:1,4003005:1,4003014:1,4003027:1,4003033:1,4003038:1,4003040:1,4003044:1,4004001:1,4004005:1,4004016:1,4004017:1,4004021:1,4004029:1,4004034:1,4004042:1,4005001:1,4005005:1,4005011:1,4006001:1,4006013:1,4006022:1,4007001:1,4007010:1,4007012:1,4007018:1,4007024:1,4007030:1,4007036:1,4007042:1,4007048:1,4007054:1,4007060:1,4007066:1,4007072:1,4007078:1,4008001:1,4008005:1,4008023:1,4009001:1,4009006:1,4009009:1,4009015:1,4010001:1,4010011:1,4010014:1,4010018:1,4010022:1,4010025:1,4010029:1,4010033:1,4011001:1,4011004:1,4011010:1,4011016:1,4011024:1,4011031:1,4012001:1,4012014:1,4013001:1,4013017:1,4013021:1,4013026:1,4014001:1,4014006:1,4014011:1,4014013:1,4014015:1,4014026:1,4014040:1,4015001:1,4015017:1,4015022:1,4015027:1,4015030:1,4015032:1,4015037:1,4016001:1,4016012:1,4016023:1,4016031:1,4016036:1,4016041:1,4016044:1,4016046:1,4017001:1,4017006:1,4017010:1,4018001:1,4018008:1,4018020:1,4018025:1,4019001:1,4019011:1,4020001:1,4020007:1,4020012:1,4020014:1,4020022:1,4021001:1,4021004:1,4021007:1,4021010:1,4021012:1,4021017:1,4021021:1,4021031:1,4021033:1,4022001:1,4022002:1,4022015:1,4022022:1,4022036:1,4023001:1,4023014:1,4023025:1,4023027:1,4024001:1,4024010:1,4024015:1,4024020:1,4025001:1,4025006:1,4025010:1,4025016:1,4026001:1,4026005:1,4026012:1,4026015:1,4026019:1,4026023:1,4026026:1,4026028:1,4026033:1,4026035:1,4026038:1,4026042:1,4026044:1,4026048:1,4026052:1,4026057:1,4026063:1,4027001:1,4027006:1,4027012:1,4027015:1,4027018:1,4028001:1,4028009:1,4028011:1,4028026:1,4029001:1,4029007:1,4029012:1,4029017:1,4029020:1,4029023:1,4029026:1,4029029:1,4029032:1,4029035:1,4030001:1,4031001:1,4031013:1,4031021:1,4031025:1,4031048:1,4032001:1,4032006:1,4032016:1,4032020:1,4032034:1,4033001:1,4033050:1,4034001:1,4034009:1,4035001:1,4035009:1,4036001:1,5001001:1,5001009:1,5001019:1,5001022:1,5002001:1,5002016:1,5002024:1,5002026:1,5003001:1,5003018:1,5003021:1,5004001:1,5004014:1,5004025:1,5004041:1,5004044:1,5005001:1,5005006:1,5005016:1,5005022:1,5006001:1,5006003:1,5006016:1,5007001:1,5007012:1,5008001:1,5009001:1,5009007:1,5010001:1,5010006:1,5010008:1,5010012:1,5011001:1,5011010:1,5011013:1,5011018:1,5011022:1,5011026:1,5012001:1,5012017:1,5012020:1,5012029:1,5013001:1,5013006:1,5013012:1,5014001:1,5014003:1,5014009:1,5014011:1,5014021:1,5014028:1,5015001:1,5015007:1,5015012:1,5015019:1,5016001:1,5016009:1,5016013:1,5016016:1,5016018:1,5016021:1,5017001:1,5017002:1,5017008:1,5017014:1,5018001:1,5018003:1,5018006:1,5018009:1,5018015:1,5019001:1,5019004:1,5019011:1,5019014:1,5019015:1,5019016:1,5020001:1,5020005:1,5020010:1,5020019:1,5021001:1,5021010:1,5021015:1,5021018:1,5021022:1,5022001:1,5022004:1,5022005:1,5022006:1,5022008:1,5022009:1,5022010:1,5022011:1,5022012:1,5022013:1,5022022:1,5022023:1,5022025:1,5022028:1,5022030:1,5023001:1,5023007:1,5023009:1,5023010:1,5023012:1,5023015:1,5023017:1,5023019:1,5023021:1,5023024:1,5024001:1,5024005:1,5024006:1,5024007:1,5024008:1,5024010:1,5024014:1,5024017:1,5024019:1,5025001:1,5025004:1,5025005:1,5025011:1,5025013:1,5025017:1,5026001:1,5026012:1,5026016:1,5027001:1,5027009:1,5027011:1,5027014:1,5028001:1,5028015:1,5029001:1,5029002:1,5029010:1,5030001:1,5030011:1,5030015:1,5031001:1,5031007:1,5031009:1,5031014:1,5031016:1,5031022:1,5031024:1,5031028:1,5032001:1,5032007:1,5032015:1,5032044:1,5033001:1,5033006:1,5033007:1,5033008:1,5033012:1,5033013:1,5033018:1,5033020:1,5033022:1,5033023:1,5033024:1,5033026:1,5034001:1,5034005:1,5034007:1,5034008:1,5034009:1,5034010:1,6001001:1,6001010:1,6001012:1,6001016:1,6002001:1,6002008:1,6002023:1,6003001:1,6003007:1,6003009:1,6003014:1,6004001:1,6004010:1,6004014:1,6004019:1,6005001:1,6005002:1,6005010:1,6005012:1,6005013:1,6006001:1,6006006:1,6006008:1,6006009:1,6006012:1,6006017:1,6006026:1,6007001:1,6007006:1,6007010:1,6007016:1,6007022:1,6008001:1,6008003:1,6008009:1,6008014:1,6008030:1,6008032:1,6009001:1,6009003:1,6009016:1,6009022:1,6010001:1,6010006:1,6010008:1,6010012:1,6010015:1,6010028:1,6010031:1,6010033:1,6010034:1,6010038:1,6010040:1,6011001:1,6011006:1,6011010:1,6011015:1,6011021:1,6012001:1,6012004:1,6012007:1,6012009:1,6013001:1,6013015:1,6013022:1,6013029:1,6014001:1,6014006:1,6015001:1,6015013:1,6015016:1,6015048:1,6015063:1,6016001:1,6016005:1,6017001:1,6017003:1,6017007:1,6018001:1,6018008:1,6018010:1,6018011:1,6019001:1,6019010:1,6019017:1,6019024:1,6019032:1,6019040:1,6019049:1,6020001:1,6020007:1,6021001:1,6021009:1,6021013:1,6021020:1,6021027:1,6021034:1,6021043:1,6022001:1,6022007:1,6022009:1,6022010:1,6022011:1,6022015:1,6022021:1,6022030:1,6022032:1,6023001:1,6024001:1,6024014:1,6024026:1,6024029:1,6024032:1,7001001:1,7001009:1,7001016:1,7001022:1,7001027:1,7001029:1,7001030:1,7001031:1,7001033:1,7002001:1,7002006:1,7002011:1,7002014:1,7002016:1,7002020:1,7003001:1,7003005:1,7003008:1,7003012:1,7003031:1,7004001:1,7004004:1,7004010:1,7004018:1,7005001:1,7006001:1,7006007:1,7006011:1,7006019:1,7006021:1,7006025:1,7006028:1,7006033:1,7006036:1,7007001:1,7007009:1,7007015:1,7007019:1,7007024:1,7008001:1,7008004:1,7008006:1,7008008:1,7008010:1,7008011:1,7008013:1,7008018:1,7008022:1,7008024:1,7008028:1,7008029:1,7008032:1,7009001:1,7009007:1,7009022:1,7009030:1,7009034:1,7009046:1,7009050:1,7009056:1,7010001:1,7010003:1,7010006:1,7010010:1,7010015:1,7011001:1,7011004:1,7011012:1,7011029:1,7011032:1,7011034:1,7012001:1,7012008:1,7012011:1,7012013:1,7013001:1,7013002:1,7013006:1,7013008:1,7013015:1,7013024:1,7014001:1,7014005:1,7014008:1,7014010:1,7014012:1,7014019:1,7015001:1,7015003:1,7015006:1,7015007:1,7015009:1,7015014:1,7015018:1,7016001:1,7016004:1,7016006:1,7016015:1,7016021:1,7017001:1,7017007:1,7018001:1,7018007:1,7018011:1,7018014:1,7018022:1,7018030:1,7019001:1,7019005:1,7019016:1,7019022:1,7019029:1,7020001:1,7020008:1,7020012:1,7020018:1,7020026:1,7021001:1,7021008:1,7021016:1,8001001:1,8001006:1,8001019:1,8002001:1,8002004:1,8002018:1,8003001:1,8003006:1,8003008:1,8003014:1,8004001:1,8004006:1,8004009:1,8004013:1,8004018:1,9001001:1,9001004:1,9001009:1,9001019:1,9001024:1,9002001:1,9002012:1,9002018:1,9002020:1,9002022:1,9002027:1,9003001:1,9003011:1,9003015:1,9003019:1,9004001:1,9004003:1,9004010:1,9004012:1,9004019:1,9005001:1,9005003:1,9005010:1,9006001:1,9006010:1,9006019:1,9006021:1,9007001:1,9007003:1,9007009:1,9007013:1,9008001:1,9008006:1,9008010:1,9008019:1,9009001:1,9009011:1,9009015:1,9009025:1,9010001:1,9010009:1,9010014:1,9010017:1,9010026:1,9011001:1,9011004:1,9011012:1,9012001:1,9012006:1,9012016:1,9012020:1,9013001:1,9013005:1,9013008:1,9013011:1,9013017:1,9013019:1,9014001:1,9014004:1,9014019:1,9014024:1,9014033:1,9014036:1,9014047:1,9015001:1,9015006:1,9015010:1,9015024:1,9015032:1,9015034:1,9016001:1,9016006:1,9016014:1,9016019:1,9017001:1,9017004:1,9017012:1,9017020:1,9017028:1,9017030:1,9017032:1,9017038:1,9017055:1,9018001:1,9018005:1,9018010:1,9018012:1,9018017:1,9018022:1,9018028:1,9019001:1,9019004:1,9019008:1,9019012:1,9019018:1,9020001:1,9020011:1,9020024:1,9020035:1,9020041:1,9021001:1,9021008:1,9021010:1,9022001:1,9022003:1,9022005:1,9022006:1,9022009:1,9022017:1,9022020:1,9023001:1,9023007:1,9023009:1,9023013:1,9023016:1,9023019:1,9023027:1,9023029:1,9024001:1,9024009:1,9024016:1,9025001:1,9025004:1,9025010:1,9025014:1,9025018:1,9025032:1,9025036:1,9025039:1,9025044:1,9026001:1,9026005:1,9026013:1,9026021:1,9027001:1,9027005:1,9027008:1,9028001:1,9028003:1,9028007:1,9028015:1,9028021:1,9029001:1,9029006:1,9029008:1,9030001:1,9030003:1,9030011:1,9030016:1,9030021:1,9030026:1,9031001:1,9031007:1,9031011:1,10001001:1,10001013:1,10001017:1,10002001:1,10002005:1,10002008:1,10002012:1,10002018:1,10002025:1,10002032:1,10003001:1,10003002:1,10003006:1,10003012:1,10003013:1,10003017:1,10003022:1,10003028:1,10003031:1,10004001:1,10004009:1,10005001:1,10005004:1,10005006:1,10005011:1,10005013:1,10005017:1,10005022:1,10006001:1,10006006:1,10006012:1,10006017:1,10006020:1,10007001:1,10007004:1,10007012:1,10007018:1,10008001:1,10008003:1,10008009:1,10008014:1,10009001:1,10009005:1,10009007:1,10009009:1,10010001:1,10010006:1,10010015:1,10011001:1,10011002:1,10011006:1,10011014:1,10011018:1,10011022:1,10011026:1,10012001:1,10012007:1,10012015:1,10012024:1,10012026:1,10013001:1,10013006:1,10013015:1,10013019:1,10013021:1,10013023:1,10013028:1,10013030:1,10013037:1,10014001:1,10014004:1,10014021:1,10014025:1,10014028:1,10015001:1,10015007:1,10015010:1,10015013:1,10015019:1,10015024:1,10015030:1,10015031:1,10015032:1,10016001:1,10016005:1,10016009:1,10016015:1,10016020:1,10017001:1,10017015:1,10017023:1,10017025:1,10017027:1,10018001:1,10018006:1,10018009:1,10018018:1,10018019:1,10018033:1,10019001:1,10019009:1,10019011:1,10019016:1,10019024:1,10019031:1,10019041:1,10020001:1,10020003:1,10020004:1,10020014:1,10020016:1,10020023:1,10021001:1,10021010:1,10021012:1,10021015:1,10022001:1,10023001:1,10023006:1,10023008:1,10024001:1,10024005:1,10024010:1,10024015:1,10024018:1,11001001:1,11001005:1,11001011:1,11001015:1,11001022:1,11001028:1,11001032:1,11001041:1,11001050:1,11002001:1,11002012:1,11002013:1,11002019:1,11002026:1,11002028:1,11002035:1,11002036:1,11003001:1,11003005:1,11003016:1,11004001:1,11004007:1,11004020:1,11004022:1,11004026:1,11004029:1,11005001:1,11005007:1,11005013:1,11006001:1,11006005:1,11006011:1,11006023:1,11006031:1,11006036:1,11006037:1,11007001:1,11007002:1,11007006:1,11007007:1,11007008:1,11007013:1,11007023:1,11007027:1,11007038:1,11007040:1,11008001:1,11008012:1,11008022:1,11008031:1,11008033:1,11008035:1,11008037:1,11008044:1,11008062:1,11009001:1,11009010:1,11009015:1,11009024:1,11009025:1,11009026:1,11010001:1,11010014:1,11010016:1,11010018:1,11010021:1,11010024:1,11010026:1,11010028:1,11011001:1,11011009:1,11011014:1,11011023:1,11011026:1,11011041:1,11012001:1,11012006:1,11012012:1,11012016:1,11012021:1,11012025:1,11013001:1,11013011:1,11013020:1,11013023:1,11013033:1,11014001:1,11014005:1,11014017:1,11014021:1,11014025:1,11014029:1,11015001:1,11015009:1,11015016:1,11015025:1,11015027:1,11015031:1,11016001:1,11016008:1,11016011:1,11016015:1,11016021:1,11016023:1,11016025:1,11016029:1,11016034:1,11017001:1,11017008:1,11017017:1,11017024:1,11018001:1,11018007:1,11018017:1,11018041:1,11019001:1,11019004:1,11019009:1,11019019:1,11020001:1,11020013:1,11020022:1,11020028:1,11020031:1,11020035:1,11021001:1,11021005:1,11021015:1,11021017:1,11021025:1,11022001:1,11022015:1,11022037:1,11022041:1,11022050:1,11022051:1,12001001:1,12001005:1,12001013:1,12001017:1,12002001:1,12002009:1,12002012:1,12002016:1,12002019:1,12002023:1,12003001:1,12003004:1,12003006:1,12003021:1,12003026:1,12004001:1,12004008:1,12004018:1,12004038:1,12004042:1,12005001:1,12005008:1,12005015:1,12005020:1,12006001:1,12006008:1,12006013:1,12006019:1,12006024:1,12006030:1,12007001:1,12007003:1,12007012:1,12007017:1,12008001:1,12008007:1,12008016:1,12008020:1,12008025:1,12008028:1,12009001:1,12009004:1,12009011:1,12009027:1,12009030:1,12010001:1,12010008:1,12010012:1,12010015:1,12010018:1,12010029:1,12010032:1,12011001:1,12011004:1,12011013:1,12011017:1,12012001:1,12012004:1,12012017:1,12012019:1,12013001:1,12013003:1,12013008:1,12013010:1,12013014:1,12013020:1,12013022:1,12014001:1,12014005:1,12014008:1,12014015:1,12014017:1,12014021:1,12014023:1,12014028:1,12015001:1,12015005:1,12015008:1,12015013:1,12015016:1,12015021:1,12015023:1,12015027:1,12015032:1,12015035:1,12015036:1,12016001:1,12016005:1,12016010:1,12016017:1,12016019:1,12017001:1,12017003:1,12017005:1,12017006:1,12017024:1,12018001:1,12018004:1,12018009:1,12018013:1,12018017:1,12019001:1,12019006:1,12019008:1,12019014:1,12019020:1,12019035:1,12020001:1,12020008:1,12020012:1,12020014:1,12020020:1,12021001:1,12021010:1,12021017:1,12021019:1,12021023:1,12022001:1,12022003:1,12022008:1,12022015:1,12023001:1,12023003:1,12023015:1,12023021:1,12023024:1,12023026:1,12023029:1,12023031:1,12023036:1,12024001:1,12024005:1,12024008:1,12024010:1,12024017:1,12025001:1,12025004:1,12025008:1,12025018:1,12025022:1,12025027:1,13001001:1,13001005:1,13001008:1,13001017:1,13001024:1,13001029:1,13001032:1,13001035:1,13001043:1,13001051:1,13002001:1,13002003:1,13002013:1,13002018:1,13002021:1,13002025:1,13002034:1,13002042:1,13002050:1,13003001:1,13003010:1,13003017:1,13004001:1,13004005:1,13004009:1,13004011:1,13004021:1,13004024:1,13004039:1,13005001:1,13005011:1,13005018:1,13005023:1,13005025:1,13006001:1,13006004:1,13006016:1,13006049:1,13006054:1,13007001:1,13007006:1,13007013:1,13007014:1,13007020:1,13007021:1,13007023:1,13007028:1,13007030:1,13008001:1,13008033:1,13009001:1,13009002:1,13009010:1,13009027:1,13009035:1,13010001:1,13010008:1,13010011:1,13010013:1,13011001:1,13011004:1,13011010:1,13011015:1,13011020:1,13011026:1,13012001:1,13012023:1,13013001:1,13013009:1,13014001:1,13014003:1,13014008:1,13015001:1,13015025:1,13015029:1,13016001:1,13016004:1,13016007:1,13016037:1,13017001:1,13017003:1,13017011:1,13017016:1,13018001:1,13018003:1,13018009:1,13018011:1,13018013:1,13018014:1,13019001:1,13019006:1,13019016:1,13020001:1,13020004:1,13021001:1,13021005:1,13021009:1,13021014:1,13021018:1,13021028:1,13022001:1,13022006:1,13022017:1,13023001:1,13023002:1,13023007:1,13023012:1,13023021:1,13023024:1,13024001:1,13024020:1,13024027:1,13025001:1,13025008:1,13026001:1,13026013:1,13026020:1,13026029:1,13027001:1,13027016:1,13027023:1,13027025:1,13028001:1,13028009:1,13028011:1,13029001:1,13029006:1,13029010:1,13029020:1,13029026:1,14001001:1,14001007:1,14001013:1,14002001:1,14002003:1,14002011:1,14002017:1,14003001:1,14003003:1,14003011:1,14003014:1,14004001:1,14004002:1,14004006:1,14004009:1,14004019:1,14005001:1,14005002:1,14005011:1,14006001:1,14006012:1,14006022:1,14006024:1,14006026:1,14006028:1,14006032:1,14007001:1,14007004:1,14007008:1,14007012:1,14008001:1,14008007:1,14008011:1,14008012:1,14008014:1,14008017:1,14009001:1,14009013:1,14009015:1,14009020:1,14009023:1,14009025:1,14009026:1,14009029:1,14010001:1,14010006:1,14010016:1,14011001:1,14011005:1,14011013:1,14011018:1,14012001:1,14012005:1,14012013:1,14013001:1,14013004:1,14013013:1,14013021:1,14014001:1,14014006:1,14014009:1,14015001:1,14015016:1,14015018:1,14016001:1,14016007:1,14016011:1,14016013:1,14017001:1,14017007:1,14017010:1,14017012:1,14018001:1,14018004:1,14019001:1,14019005:1,14019008:1,14020001:1,14020005:1,14020014:1,14020020:1,14020022:1,14020026:1,14020031:1,14020035:1,14021001:1,14021005:1,14021008:1,14021012:1,14021016:1,14021018:1,14022001:1,14022005:1,14022010:1,14023001:1,14023012:1,14023016:1,14024001:1,14024004:1,14024015:1,14024023:1,14024027:1,14025001:1,14025003:1,14025005:1,14025011:1,14025013:1,14025014:1,14025017:1,14025025:1,14025027:1,14026001:1,14026016:1,14026022:1,14027001:1,14027005:1,14027007:1,14027009:1,14028001:1,14028006:1,14028016:1,14028022:1,14028026:1,14029001:1,14029003:1,14029012:1,14029020:1,14030001:1,14030013:1,14030027:1,14031001:1,14031002:1,14031005:1,14031011:1,14031020:1,14032001:1,14032009:1,14032021:1,14032024:1,14032027:1,14032031:1,14032032:1,14033001:1,14033003:1,14033011:1,14033018:1,14033020:1,14033021:1,14033025:1,14034001:1,14034003:1,14034008:1,14034014:1,14034023:1,14034029:1,14035001:1,14035020:1,14035025:1,14036001:1,14036005:1,14036009:1,14036011:1,14036014:1,14036022:1,15001001:1,15001005:1,15001007:1,15002001:1,15002036:1,15002040:1,15002041:1,15002042:1,15002043:1,15002055:1,15002061:1,15002064:1,15002068:1,15003001:1,15003008:1,15004001:1,15004007:1,15004011:1,15004017:1,15004023:1,15005001:1,15005003:1,15005006:1,15006001:1,15006013:1,15006016:1,15007001:1,15007011:1,15007027:1,15008001:1,15008015:1,15008021:1,15008024:1,15008031:1,15008033:1,15008036:1,15009001:1,15009005:1,15010001:1,15010006:1,15010009:1,15010015:1,15010018:1,16001001:1,16001004:1,16002001:1,16002009:1,16002012:1,16002017:1,16003001:1,16004001:1,16004007:1,16004013:1,16004019:1,16005001:1,16005006:1,16005014:1,16006001:1,16006015:1,16006017:1,16007001:1,16007005:1,16007039:1,16007043:1,16007044:1,16007045:1,16007046:1,16007057:1,16007063:1,16007066:1,16007070:1,16008001:1,16008009:1,16008013:1,16008016:1,16009001:1,16009004:1,16010001:1,16010028:1,16011001:1,16011003:1,16011020:1,16012001:1,16012010:1,16012022:1,16012027:1,16012044:1,16013001:1,16013004:1,16013010:1,16013015:1,16013023:1,17001001:1,17001010:1,17001013:1,17002001:1,17002005:1,17002008:1,17002012:1,17002015:1,17002021:1,17003001:1,17003007:1,17003008:1,17004001:1,17004004:1,17004010:1,17004015:1,17005001:1,17005006:1,17005009:1,17005014:1,17006001:1,17006004:1,17006012:1,17007001:1,17007005:1,17007007:1,17008001:1,17008003:1,17008007:1,17008015:1,17009001:1,17009012:1,17009020:1,17010001:1,18001001:1,18001006:1,18001013:1,18002001:1,18002007:1,18002009:1,18002011:1,18003001:1,18004001:1,18005001:1,18006001:1,18007001:1,18008001:1,18009001:1,18010001:1,18011001:1,18012001:1,18013001:1,18014001:1,18015001:1,18016001:1,18017001:1,18018001:1,18019001:1,18020001:1,18021001:1,18022001:1,18023001:1,18024001:1,18025001:1,18026001:1,18027001:1,18028001:1,18029001:1,18030001:1,18031001:1,18032001:1,18033001:1,18034001:1,18035001:1,18036001:1,18037001:1,18038001:1,18039001:1,18040001:1,18040003:1,18040006:1,18040015:1,18041001:1,18042001:1,18042007:1,19001001:1,19002001:1,19003000:1,19003001:1,19004000:1,19004001:1,19005000:1,19005001:1,19006000:1,19006001:1,19007000:1,19007001:1,19008000:1,19008001:1,19009000:1,19009001:1,19010001:1,19011000:1,19011001:1,19012000:1,19012001:1,19013000:1,19013001:1,19014000:1,19014001:1,19015000:1,19015001:1,19016000:1,19016001:1,19017000:1,19017001:1,19018000:1,19018001:1,19019000:1,19019001:1,19020000:1,19020001:1,19021000:1,19021001:1,19022000:1,19022001:1,19023000:1,19023001:1,19024000:1,19024001:1,19025000:1,19025001:1,19026000:1,19026001:1,19027000:1,19027001:1,19028000:1,19028001:1,19029000:1,19029001:1,19030000:1,19030001:1,19031000:1,19031001:1,19032000:1,19032001:1,19033001:1,19034000:1,19034001:1,19035000:1,19035001:1,19036000:1,19036001:1,19037000:1,19037001:1,19038000:1,19038001:1,19039000:1,19039001:1,19040000:1,19040001:1,19041000:1,19041001:1,19042000:1,19042001:1,19043001:1,19044000:1,19044001:1,19045000:1,19045001:1,19046000:1,19046001:1,19047000:1,19047001:1,19048000:1,19048001:1,19049000:1,19049001:1,19050000:1,19050001:1,19051000:1,19051001:1,19052000:1,19052001:1,19053000:1,19053001:1,19054000:1,19054001:1,19055000:1,19055001:1,19056000:1,19056001:1,19057000:1,19057001:1,19058000:1,19058001:1,19059000:1,19059001:1,19060000:1,19060001:1,19061000:1,19061001:1,19062000:1,19062001:1,19063000:1,19063001:1,19064000:1,19064001:1,19065000:1,19065001:1,19066000:1,19066001:1,19067000:1,19067001:1,19068000:1,19068001:1,19069000:1,19069001:1,19070000:1,19070001:1,19071001:1,19072000:1,19072001:1,19073000:1,19073001:1,19074000:1,19074001:1,19075000:1,19075001:1,19076000:1,19076001:1,19077000:1,19077001:1,19078000:1,19078001:1,19079000:1,19079001:1,19080000:1,19080001:1,19081000:1,19081001:1,19082000:1,19082001:1,19083000:1,19083001:1,19084000:1,19084001:1,19085000:1,19085001:1,19086000:1,19086001:1,19087000:1,19087001:1,19088000:1,19088001:1,19089000:1,19089001:1,19090000:1,19090001:1,19091001:1,19092000:1,19092001:1,19093001:1,19094001:1,19095001:1,19096001:1,19097001:1,19098000:1,19098001:1,19099001:1,19100000:1,19100001:1,19101000:1,19101001:1,19102000:1,19102001:1,19103000:1,19103001:1,19104001:1,19105001:1,19106001:1,19107001:1,19108000:1,19108001:1,19109000:1,19109001:1,19110000:1,19110001:1,19111001:1,19112001:1,19113001:1,19114001:1,19115001:1,19116001:1,19117001:1,19118001:1,19119001:1,19119009:1,19119017:1,19119025:1,19119033:1,19119041:1,19119049:1,19119057:1,19119065:1,19119073:1,19119081:1,19119089:1,19119097:1,19119105:1,19119113:1,19119121:1,19119129:1,19119137:1,19119145:1,19119153:1,19119161:1,19119169:1,19120000:1,19120001:1,19121000:1,19121001:1,19122000:1,19122001:1,19123000:1,19123001:1,19124000:1,19124001:1,19125000:1,19125001:1,19126000:1,19126001:1,19127000:1,19127001:1,19128000:1,19128001:1,19129000:1,19129001:1,19130000:1,19130001:1,19131000:1,19131001:1,19132000:1,19132001:1,19133000:1,19133001:1,19134000:1,19134001:1,19135001:1,19136001:1,19137001:1,19138000:1,19138001:1,19139000:1,19139001:1,19140000:1,19140001:1,19141000:1,19141001:1,19142000:1,19142001:1,19143000:1,19143001:1,19144000:1,19144001:1,19145000:1,19145001:1,19146001:1,19147001:1,19148001:1,19149001:1,19150001:1,20001001:1,20001007:1,20001010:1,20001020:1,20001024:1,20002001:1,20002010:1,20003001:1,20003005:1,20003007:1,20003011:1,20003013:1,20003021:1,20003027:1,20003030:1,20003031:1,20003033:1,20004001:1,20004014:1,20004020:1,20004023:1,20005001:1,20005003:1,20005015:1,20005022:1,20006001:1,20006006:1,20006012:1,20006016:1,20006020:1,20007001:1,20007006:1,20007024:1,20008001:1,20009001:1,20009013:1,20010001:1,20011001:1,20012001:1,20013001:1,20014001:1,20015001:1,20016001:1,20017001:1,20018001:1,20019001:1,20020001:1,20021001:1,20022001:1,20023001:1,20024001:1,20025001:1,20026001:1,20027001:1,20028001:1,20029001:1,20030001:1,20031001:1,20031010:1,21001001:1,21001012:1,21002001:1,21002012:1,21002018:1,21002024:1,21003001:1,21003016:1,21004001:1,21004004:1,21004007:1,21004009:1,21004013:1,21005001:1,21005008:1,21005009:1,21005018:1,21006001:1,21006003:1,21006006:1,21006009:1,21006011:1,21007001:1,21007002:1,21007007:1,21007011:1,21007023:1,21008001:1,21008006:1,21008012:1,21008016:1,21009001:1,21009004:1,21009007:1,21009011:1,21009013:1,21010001:1,21010016:1,21010018:1,21010019:1,21010020:1,21011001:1,21011007:1,21011009:1,21012001:1,21012008:1,21012013:1,22001001:1,22001008:1,22001012:1,22002001:1,22002008:1,22002014:1,22002016:1,22003001:1,22003006:1,22004001:1,22004008:1,22004016:1,22005001:1,22005002:1,22005009:1,22006001:1,22006004:1,22006010:1,22007001:1,22007010:1,22008001:1,22008006:1,22008008:1,22008014:1,23001001:1,23001005:1,23001010:1,23001016:1,23001021:1,23001025:1,23001028:1,23002001:1,23002006:1,23002010:1,23003001:1,23003009:1,23003012:1,23003016:1,23004001:1,23005001:1,23005008:1,23005011:1,23005013:1,23005020:1,23005026:1,23006001:1,23006005:1,23006009:1,23006013:1,23007001:1,23007010:1,23007017:1,23008001:1,23008005:1,23008009:1,23008011:1,23008019:1,23009001:1,23009008:1,23009013:1,23009018:1,23010001:1,23010005:1,23010020:1,23010024:1,23011001:1,23011010:1,23012001:1,23013001:1,23013006:1,23013019:1,23014001:1,23014004:1,23014024:1,23014029:1,23015001:1,23016001:1,23016006:1,23016009:1,23016012:1,23017001:1,23017006:1,23017009:1,23017012:1,23018001:1,23018007:1,23019001:1,23019011:1,23019018:1,23019023:1,23020001:1,23021001:1,23021011:1,23021013:1,23022001:1,23022008:1,23022015:1,23022020:1,23023001:1,23023017:1,23024001:1,23024013:1,23024016:1,23025001:1,23025006:1,23025009:1,23026001:1,23026005:1,23026012:1,23026020:1,23027001:1,23027007:1,23027012:1,23028001:1,23028005:1,23028007:1,23028009:1,23028014:1,23028016:1,23028018:1,23028023:1,23029001:1,23029007:1,23029009:1,23029013:1,23029018:1,23030001:1,23030008:1,23030018:1,23030027:1,23031001:1,23031006:1,23031008:1,23032001:1,23032009:1,23033001:1,23033013:1,23034001:1,23034011:1,23034016:1,23035001:1,23035003:1,23036001:1,23036004:1,23036011:1,23036012:1,23036022:1,23037001:1,23037006:1,23037008:1,23037014:1,23037021:1,23037037:1,23038001:1,23038004:1,23038009:1,23039001:1,23039003:1,23040001:1,23040003:1,23040009:1,23040012:1,23040018:1,23040028:1,23041001:1,23041010:1,23042001:1,23042005:1,23042017:1,23043001:1,23043008:1,23043014:1,23043018:1,23043022:1,23044001:1,23044009:1,23044021:1,23045001:1,23045005:1,23045020:1,23046001:1,23046003:1,23046005:1,23046012:1,23047001:1,23047006:1,23047007:1,23047010:1,23047011:1,23048001:1,23048009:1,23048012:1,23048016:1,23048020:1,23049001:1,23049005:1,23049013:1,23049018:1,23049024:1,23050001:1,23050005:1,23050007:1,23050010:1,23051001:1,23051004:1,23051007:1,23051009:1,23051017:1,23051021:1,23052001:1,23052007:1,23052009:1,23052011:1,23052013:1,23053001:1,23053004:1,23053010:1,23054001:1,23054011:1,23054017:1,23055001:1,23055006:1,23055008:1,23056001:1,23056003:1,23056009:1,23057001:1,23057003:1,23057013:1,23058001:1,23058003:1,23058008:1,23058013:1,23059001:1,23059009:1,23059016:1,23059020:1,23060001:1,23061001:1,23061004:1,23061007:1,23062001:1,23062005:1,23062010:1,23063001:1,23063007:1,23063010:1,23063015:1,23063017:1,23064001:1,23064009:1,23065001:1,23065008:1,23065011:1,23065017:1,23066001:1,23066005:1,24001001:1,24001007:1,24001011:1,24001017:1,24002001:1,24002005:1,24002009:1,24002014:1,24002020:1,24002031:1,24003001:1,24003006:1,24003012:1,24003020:1,24004001:1,24004003:1,24004019:1,24005001:1,24005007:1,24005010:1,24005019:1,24005025:1,24005030:1,24006001:1,24006006:1,24006009:1,24006018:1,24006026:1,24007001:1,24007008:1,24007017:1,24007021:1,24007029:1,24007032:1,24008001:1,24008004:1,24008013:1,24008018:1,24009001:1,24009009:1,24009012:1,24009017:1,24009023:1,24009025:1,24010001:1,24010017:1,24010019:1,24010023:1,24011001:1,24011011:1,24011018:1,24012001:1,24012005:1,24012007:1,24012014:1,24013001:1,24013012:1,24013015:1,24013022:1,24014001:1,24014007:1,24014010:1,24014013:1,24014017:1,24015001:1,24015010:1,24015015:1,24015019:1,24016001:1,24016010:1,24016014:1,24016016:1,24017001:1,24017005:1,24017009:1,24017012:1,24017015:1,24017019:1,24018001:1,24018011:1,24018018:1,24019001:1,24020001:1,24020007:1,24020010:1,24020014:1,24021001:1,24021003:1,24021008:1,24021011:1,24022001:1,24022010:1,24022013:1,24022020:1,24023001:1,24023005:1,24023009:1,24023033:1,24024001:1,24024004:1,24024008:1,24025001:1,24025008:1,24025012:1,24025015:1,24025034:1,24026001:1,24026008:1,24026010:1,24026012:1,24026016:1,24027001:1,24027012:1,24027019:1,24028001:1,24028005:1,24028010:1,24028012:1,24028015:1,24029001:1,24029008:1,24029010:1,24029015:1,24029020:1,24029024:1,24029030:1,24030001:1,24030004:1,24030010:1,24030018:1,24031001:1,24031010:1,24031015:1,24031018:1,24031022:1,24031027:1,24031031:1,24031035:1,24031038:1,24032001:1,24032006:1,24032013:1,24032016:1,24032026:1,24032036:1,24033001:1,24033009:1,24033015:1,24033017:1,24033019:1,24034001:1,24034008:1,24034012:1,24035001:1,24035012:1,24035018:1,24036001:1,24036011:1,24036020:1,24036027:1,24036032:1,24037001:1,24037006:1,24037011:1,24037016:1,24038001:1,24038007:1,24038014:1,24038024:1,24039001:1,24039004:1,24039008:1,24039011:1,24039015:1,24040001:1,24040007:1,24040013:1,24041001:1,24041011:1,24042001:1,24042007:1,24042013:1,24042019:1,24043001:1,24043008:1,24044001:1,24044011:1,24044015:1,24044020:1,24044029:1,24045001:1,24045004:1,24046001:1,24046013:1,24046027:1,24047001:1,24048001:1,24048007:1,24048011:1,24048014:1,24048026:1,24048047:1,24049001:1,24049007:1,24049023:1,24049028:1,24049030:1,24049034:1,24049039:1,24050001:1,24050004:1,24050009:1,24050017:1,24050021:1,24050033:1,24050035:1,24051001:1,24051059:1,24052001:1,24052004:1,24052008:1,24052012:1,24052024:1,24052031:1,25001001:1,25001012:1,25001018:1,25002001:1,25002020:1,25003001:1,25003022:1,25003037:1,25003055:1,25003064:1,25004001:1,25004013:1,25004021:1,25004022:1,25005001:1,26001001:1,26001004:1,26001015:1,26001026:1,26002001:1,26002006:1,26002009:1,26003001:1,26003004:1,26003015:1,26003022:1,26004001:1,26004009:1,26005001:1,26005005:1,26005012:1,26006001:1,26006008:1,26006011:1,26007001:1,26007016:1,26007020:1,26007023:1,26008001:1,26008005:1,26008007:1,26008013:1,26008015:1,26008017:1,26009001:1,26009005:1,26009008:1,26010001:1,26010008:1,26011001:1,26011004:1,26011013:1,26011022:1,26011024:1,26012001:1,26012008:1,26012017:1,26012021:1,26012026:1,26013001:1,26013010:1,26013017:1,26014001:1,26014006:1,26014012:1,26014015:1,26014017:1,26014019:1,26014022:1,26015001:1,26015006:1,26016001:1,26016006:1,26016015:1,26016035:1,26016044:1,26016060:1,26017001:1,26017011:1,26017022:1,26018001:1,26018005:1,26018010:1,26018014:1,26018019:1,26018024:1,26018025:1,26018031:1,26019001:1,26019010:1,26020001:1,26020005:1,26020010:1,26020027:1,26020033:1,26020045:1,26021001:1,26021008:1,26021018:1,26021025:1,26021028:1,26022001:1,26022013:1,26022023:1,26023001:1,26023022:1,26023036:1,26023045:1,26024001:1,26024006:1,26024015:1,26024019:1,26025001:1,26025008:1,26025012:1,26025015:1,26026001:1,26026007:1,26026015:1,26027001:1,26027026:1,26028001:1,26028011:1,26028020:1,26028024:1,26029001:1,26029008:1,26029013:1,26029017:1,26029021:1,26030001:1,26030020:1,26031001:1,26031003:1,26031010:1,26031018:1,26032001:1,26032011:1,26032017:1,26033001:1,26033007:1,26033017:1,26033020:1,26033021:1,26033030:1,26034001:1,26034007:1,26034011:1,26034020:1,26035001:1,26036001:1,26036008:1,26036016:1,26036021:1,26036025:1,26037001:1,26037011:1,26037015:1,26037018:1,26037020:1,26038001:1,26038008:1,26038014:1,26039001:1,26039008:1,26039011:1,26039017:1,26039023:1,26040001:1,26040006:1,26040020:1,26040024:1,26040032:1,26040035:1,26040039:1,26040044:1,26040048:1,26041001:1,26042001:1,26042013:1,26042019:1,26043001:1,26043007:1,26043010:1,26043013:1,26043018:1,26044001:1,26044004:1,26044009:1,26044015:1,26044017:1,26045001:1,26045006:1,26045007:1,26045009:1,26046001:1,26046009:1,26046016:1,26046019:1,26047001:1,26047006:1,26047013:1,26047022:1,26048001:1,26048008:1,26048015:1,26048021:1,26048030:1,27001001:1,27001003:1,27001008:1,27001017:1,27002001:1,27002010:1,27002014:1,27002019:1,27002024:1,27002031:1,27002036:1,27002046:1,27003001:1,27003008:1,27003013:1,27003019:1,27003026:1,27004001:1,27004004:1,27004008:1,27004019:1,27004028:1,27005001:1,27005005:1,27005010:1,27005017:1,27005025:1,27005030:1,27006001:1,27006004:1,27006010:1,27006018:1,27006024:1,27006025:1,27007001:1,27007009:1,27007015:1,27008001:1,27008013:1,27008015:1,27009001:1,27009003:1,27009016:1,27009020:1,27010001:1,27010010:1,27011001:1,27011005:1,27011030:1,27012001:1,27012005:1,28001001:1,28001006:1,28001008:1,28001010:1,28002001:1,28002006:1,28002014:1,28003001:1,28004001:1,28004006:1,28004012:1,28004015:1,28005001:1,28005015:1,28006001:1,28006004:1,28007001:1,28007011:1,28008001:1,28008005:1,28009001:1,28010001:1,28011001:1,28011005:1,28012001:1,28012003:1,28012007:1,28013001:1,28013005:1,28013009:1,28013015:1,28014001:1,28014004:1,29001001:1,29001008:1,29001014:1,29002001:1,29002012:1,29002015:1,29002018:1,29002021:1,29002028:1,29003001:1,29003009:1,29003018:1,30001001:1,30001006:1,30001009:1,30001011:1,30001013:1,30002001:1,30002004:1,30002006:1,30002009:1,30003001:1,30003009:1,30004001:1,30004004:1,30004006:1,30005001:1,30005004:1,30005021:1,30006001:1,30006007:1,30006012:1,30007001:1,30007004:1,30007007:1,30007010:1,30007014:1,30007016:1,30008001:1,30008004:1,30008011:1,30009001:1,30009011:1,31001001:1,31001003:1,31001010:1,31001017:1,32001001:1,32001004:1,32001011:1,32001017:1,32002001:1,32002010:1,32003001:1,32003005:1,32003010:1,32004001:1,32004004:1,33001001:1,33001010:1,33002001:1,33002004:1,33002007:1,33002012:1,33003001:1,33003005:1,33003008:1,33004001:1,33004003:1,33004008:1,33004011:1,33005001:1,33005004:1,33005008:1,33006001:1,33006006:1,33006010:1,33006016:1,33007001:1,33007003:1,33007005:1,33007008:1,33007014:1,33007016:1,34001001:1,34002001:1,34003001:1,35001001:1,35001005:1,35001012:1,35002001:1,35002005:1,35002009:1,35002012:1,35002015:1,35002018:1,35003001:1,35003017:1,36001001:1,36002001:1,36002004:1,36002008:1,36002012:1,36003001:1,36003008:1,36003014:1,37001001:1,37001007:1,37001012:1,37002001:1,37002010:1,37002020:1,38001001:1,38001007:1,38001012:1,38001018:1,38002001:1,38002006:1,38002010:1,38003001:1,38004001:1,38004011:1,38005001:1,38005005:1,38006001:1,38006009:1,38007001:1,38007004:1,38007008:1,38008001:1,38008009:1,38008016:1,38008018:1,38009001:1,38009009:1,38009012:1,38010001:1,38010005:1,38011001:1,38011003:1,38011010:1,38011015:1,38012001:1,38012003:1,38012006:1,38012009:1,38013001:1,38013002:1,38013007:1,38014001:1,38014004:1,38014012:1,38014016:1,38014020:1,39001001:1,39001006:1,39001012:1,39002001:1,39002011:1,39002014:1,39002017:1,39003001:1,39003007:1,39003008:1,39003013:1,39003016:1,39004001:1,39004002:1,39004004:1,39004005:1,40001001:1,40001018:1,40002001:1,40002011:1,40002016:1,40002019:1,40003001:1,40003007:1,40003013:1,40004001:1,40004012:1,40004017:1,40004018:1,40004023:1,40005001:1,40005013:1,40005017:1,40005021:1,40005027:1,40005033:1,40005038:1,40005043:1,40006001:1,40006005:1,40006016:1,40006019:1,40006024:1,40007001:1,40007006:1,40007007:1,40007013:1,40007015:1,40007021:1,40007024:1,40008001:1,40008005:1,40008014:1,40008016:1,40008018:1,40008023:1,40008028:1,40009001:1,40009009:1,40009010:1,40009014:1,40009018:1,40009020:1,40009027:1,40009032:1,40009036:1,40010001:1,40010016:1,40010040:1,40011001:1,40011007:1,40011016:1,40011020:1,40011025:1,40011028:1,40012001:1,40012010:1,40012014:1,40012022:1,40012031:1,40012038:1,40012046:1,40013001:1,40013018:1,40013024:1,40013031:1,40013033:1,40013044:1,40013045:1,40013047:1,40013053:1,40014001:1,40014003:1,40014013:1,40014015:1,40014022:1,40014034:1,40015001:1,40015010:1,40015021:1,40015032:1,40016001:1,40016006:1,40016013:1,40016021:1,40016024:1,40017001:1,40017014:1,40017022:1,40017024:1,40018001:1,40018007:1,40018015:1,40018021:1,40018023:1,40019001:1,40019003:1,40019010:1,40019013:1,40019016:1,40019023:1,40019027:1,40020001:1,40020017:1,40020020:1,40020030:1,40021001:1,40021012:1,40021017:1,40021023:1,40021028:1,40021033:1,40022001:1,40022011:1,40022015:1,40022023:1,40022034:1,40022041:1,40023001:1,40023013:1,40023034:1,40024001:1,40024003:1,40024029:1,40024036:1,40024042:1,40025001:1,40025014:1,40025031:1,40026001:1,40026006:1,40026014:1,40026017:1,40026026:1,40026036:1,40026047:1,40026057:1,40026069:1,40027001:1,40027003:1,40027019:1,40027024:1,40027026:1,40027029:1,40027034:1,40027039:1,40027050:1,40027062:1,40028001:1,40028009:1,40028011:1,40028016:1,40028019:1,41001001:1,41002001:1,41003001:1,41003022:1,41003031:1,41004001:1,41004014:1,41004021:1,41004026:1,41004030:1,41005001:1,41006001:1,41006007:1,41007001:1,41007014:1,41007024:1,41007031:1,41008001:1,41008010:1,41008014:1,41008022:1,41008027:1,41008034:1,41009001:1,41009002:1,41009011:1,41009014:1,41009030:1,41009033:1,41009038:1,41010001:1,41010002:1,41010013:1,41010017:1,41010023:1,41010028:1,41010032:1,41010035:1,41010046:1,41011001:1,41011012:1,41011015:1,41011020:1,41011027:1,41012001:1,41012013:1,41012018:1,41012028:1,41012035:1,41012038:1,41012041:1,41013001:1,41013009:1,41013014:1,41013024:1,41013032:1,41014001:1,41014003:1,41014010:1,41014012:1,41014022:1,41014026:1,41014043:1,41014046:1,41014053:1,41014066:1,41015001:1,41015015:1,41015039:1,41015042:1,41016001:1,41016009:1,41016012:1,41016014:1,41016019:1,42001001:1,42001005:1,42002001:1,42003001:1,42004001:1,42004014:1,42004016:1,42004033:1,42004038:1,42004040:1,42005001:1,42005012:1,42005016:1,42005018:1,42005027:1,42005033:1,42005036:1,42006001:1,42006013:1,42006017:1,42006020:1,42006027:1,42006046:1,42007001:1,42007011:1,42007019:1,42007024:1,42007031:1,42007036:1,42008001:1,42008004:1,42008016:1,42008019:1,42008022:1,42008026:1,42008037:1,42008041:1,42008043:1,42008049:1,42009001:1,42009007:1,42009010:1,42009018:1,42009023:1,42009028:1,42009037:1,42009043:1,42009046:1,42009049:1,42009051:1,42009057:1,42010001:1,42010017:1,42010021:1,42010023:1,42010025:1,42010038:1,42011001:1,42011014:1,42011027:1,42011029:1,42011037:1,42011045:1,42012001:1,42012013:1,42012022:1,42012031:1,42012041:1,42012049:1,42012054:1,42012058:1,42013001:1,42013006:1,42013011:1,42013018:1,42013024:1,42013031:1,42014001:1,42014007:1,42014012:1,42014015:1,42014025:1,42014034:1,42015001:1,42015003:1,42015008:1,42015011:1,42016001:1,42016013:1,42016019:1,42017001:1,42017003:1,42017011:1,42017020:1,42018001:1,42018031:1,42018035:1,42019001:1,42019028:1,42019041:1,42020001:1,42020019:1,42020027:1,42020039:1,42020045:1,42021001:1,42021005:1,42021025:1,42021034:1,42022001:1,42022003:1,42022007:1,42022019:1,42022021:1,42022024:1,42022031:1,42022039:1,42022047:1,42022050:1,42022054:1,42022063:1,42022066:1,42023001:1,42023008:1,42023012:1,42023013:1,42023027:1,42023034:1,42023039:1,42023046:1,42023050:1,42024001:1,42024013:1,42024036:1,42024049:1,42024050:1,43001001:1,43001006:1,43001015:1,43001019:1,43001029:1,43001035:1,43001043:1,43002001:1,43002012:1,43002013:1,43002018:1,43002023:1,43003001:1,43003014:1,43003016:1,43003018:1,43003022:1,43003023:1,43003025:1,43004001:1,43004027:1,43004031:1,43004039:1,43004043:1,43005001:1,43005010:1,43005017:1,43005032:1,43005036:1,43005039:1,43006001:1,43006005:1,43006015:1,43006022:1,43006066:1,43007001:1,43007010:1,43007014:1,43007032:1,43007040:1,43007045:1,43008001:1,43008012:1,43008033:1,43009001:1,43009008:1,43009013:1,43009039:1,43010001:1,43010019:1,43010022:1,43011001:1,43011047:1,43011055:1,43012001:1,43012010:1,43012012:1,43012020:1,43012023:1,43012037:1,43012042:1,43012044:1,43013001:1,43013018:1,43013031:1,43013036:1,43014001:1,43014015:1,43015001:1,43016001:1,43017001:1,43018001:1,43018015:1,43018019:1,43018028:1,43019001:1,43019008:1,43019013:1,43019019:1,43019023:1,43019025:1,43019028:1,43019038:1,43020001:1,43020011:1,43020019:1,43020024:1,43020026:1,43020030:1,43021001:1,43021015:1,44001001:1,44001015:1,44002001:1,44002014:1,44002037:1,44002041:1,44003001:1,44003012:1,44003019:1,44004001:1,44004005:1,44004013:1,44004023:1,44004031:1,44005001:1,44005012:1,44005017:1,44005029:1,44005033:1,44005041:1,44006001:1,44006005:1,44006009:1,44007001:1,44007037:1,44007051:1,44007054:1,44008001:1,44009001:1,44009010:1,44009023:1,44009032:1,44009036:1,44010001:1,44010009:1,44010019:1,44010034:1,44010044:1,44011001:1,44011019:1,44011022:1,44011027:1,44012001:1,44012020:1,44012024:1,44013001:1,44013004:1,44013014:1,44013038:1,44013044:1,44014001:1,44014008:1,44014019:1,44015001:1,44015006:1,44015012:1,44015013:1,44015036:1,44016001:1,44016014:1,44016016:1,44016019:1,44016025:1,44017001:1,44017005:1,44017010:1,44017016:1,44017022:1,44017032:1,44018001:1,44018007:1,44018012:1,44018018:1,44018024:1,44019001:1,44019013:1,44019021:1,44020001:1,44020013:1,44020017:1,44020028:1,44020036:1,44021001:1,44022001:1,44023001:1,44024001:1,44025001:1,44026001:1,44027001:1,44028001:1,45001001:1,45002001:1,45003001:1,45004001:1,45005001:1,45006001:1,45007001:1,45008001:1,45009001:1,45010001:1,45011001:1,45012001:1,45013001:1,45014001:1,45015001:1,45016001:1,46001001:1,46002001:1,46003001:1,46004001:1,46005001:1,46006001:1,46007001:1,46008001:1,46009001:1,46010001:1,46011001:1,46012001:1,46013001:1,46014001:1,46015001:1,46016001:1,47001001:1,47002001:1,47003001:1,47004001:1,47005001:1,47006001:1,47007001:1,47008001:1,47009001:1,47010001:1,47011001:1,47012001:1,47013001:1,48001001:1,48002001:1,48003001:1,48004001:1,48005001:1,48006001:1,49001001:1,49002001:1,49003001:1,49004001:1,49005001:1,49006001:1,50001001:1,50002001:1,50003001:1,50004001:1,51001001:1,51002001:1,51003001:1,51004001:1,52001001:1,52002001:1,52003001:1,52004001:1,52005001:1,53001001:1,53002001:1,53003001:1,54001001:1,54002001:1,54003001:1,54004001:1,54005001:1,54006001:1,55001001:1,55002001:1,55003001:1,55004001:1,56001001:1,56002001:1,56003001:1,57001001:1,58001001:1,58002001:1,58003001:1,58004001:1,58005001:1,58006001:1,58007001:1,58008001:1,58009001:1,58010001:1,58011001:1,58012001:1,58013001:1,59001001:1,59002001:1,59003001:1,59004001:1,59005001:1,60001001:1,60002001:1,60003001:1,60004001:1,60005001:1,61001001:1,61002001:1,61003001:1,62001001:1,62002001:1,62003001:1,62004001:1,62005001:1,63001001:1,64001001:1,65001001:1,66001001:1,66002001:1,66003001:1,66004001:1,66005001:1,66006001:1,66007001:1,66008001:1,66009001:1,66010001:1,66011001:1,66012001:1,66013001:1,66014001:1,66015001:1,66016001:1,66017001:1,66018001:1,66019001:1,66020001:1,66021001:1,66022001:1},
        zeros = ["", "00", "0", ""];
    
    context.generate_table_structure(lang, word_len, notes_len, function ()
    {
        var len = data.length;
        
        (function loop(i)
        {
            var last_char,
                words,
                words_len;
            
            if (i >= len) {
                if (callback) {
                    callback();
                }
                return;
            }
            
            /// If the line ends with a quotation mark, add it to the beginning of the next line.
            last_char = data[i].text.slice(-1);
            if (last_char === "「" || last_char === "『" ) {
                data[i + 1].text = last_char + data[i + 1].text;
                data[i].text = data[i].text.slice(0, -1);
            }
            
            words = compile_arr(segment(data[i].text));
            words_len = words.length;
            
            ///NOTE: We need to resuse the same object because add_row() adds properties to it.
            obj.b = data[i].b;
            obj.c = data[i].c;
            obj.v = data[i].v;
            
            /// Use the KJV 1611's paragraph markings for now.
            obj.paragraph = paragraphs_1611[obj.b + zeros[String(obj.c).length] + obj.c + zeros[String(obj.v).length] + obj.v] || 0;
            
            (function loop2(j)
            {
                /// Did we loop through all of the words.
                if (j >= words_len) {
                    setTimeout(function ()
                    {
                        /// On to the next verse.
                        loop(i + 1);
                    }, 0);
                    return;
                }
                
                obj.word = words[j];
                
                context.add_row(lang, obj, function (data, err)
                {
                    if (err) {
                        console.warn(err);
                        throw "Error";
                    }
                    /// Paragraph markings are only on the first word in a verse.
                    obj.paragraph = 0;
                    /// Next word.
                    loop2(j + 1);
                });
            }(0));
        }(0));
        
    });
}

function create_simplified_version(trad)
{
    return require(language_dir + "trad2simp.js").trad2simp(trad);
}

function run_auto_convert(type, lang, text, callback)
{
    var tmpfile = process.cwd() + "/tmp_ckjv_" + type + "_" + random_numbers();
    fs.writeFileSync(tmpfile, text);
    
    auto_convert(language_dir + "dict_" + type + ".js", tmpfile, function (files)
    {
        var static_path = process.cwd() + "/" + config.static_path,
            code,
            plot_data;
        
        /// Remove temporary CKJV file.
        fs.unlinkSync(tmpfile);
        
        /// Remove intermidate dictionary files.
        fs.unlinkSync(files.filtered1_file);
        fs.unlinkSync(files.filtered2_file);
        
        ///NOTE: .slice(13) trims off "this." from the file.
        forge(static_path + "/js/lang/" + lang + ".js", "Analysis", ["var " + fs.readFileSync(files.analysis_file, "utf8").trim().slice(5) + ","])
        
        /// Move the analysis file to the Chinese language code section.
        fs.unlinkSync(language_dir + "analysis_" + type + ".js");
        fs.rename(files.analysis_file, language_dir + "analysis_" + type + ".js");
        
        /// Move the weights file to the Chinese language code section.
        ///NOTE: This file is not currently used, but it code be useful since it takes a long time to generate.
        fs.unlinkSync(language_dir + "weights_" + type + ".js");
        fs.rename(files.weights_file, language_dir + "weights_" + type + ".js");
        
        /// Copy the analysis file to the Chinese language code section.
        fs.unlinkSync(language_dir + "dict_raw_" + type);
        copy_file(files.raw_file, language_dir + "dict_raw_" + type);
        
        /// Replace the dictionary in the code.
        fs.unlinkSync(static_path + "/js/misc/" + lang + "_dict");
        fs.rename(files.raw_file, static_path + "/js/misc/" + lang + "_dict");
        
        /// Merge in plot data.
        plot_data = fs.readFileSync(files.plot_data_file, "utf8");
        code = fs.readFileSync(static_path + "/js/misc/zh_segment.js", "utf8");
        if (type === "trad") {
            forge(static_path + "/js/misc/zh_segment.js", "Traditional Chinese Plot Data", ["p = " + plot_data + ";"]);
            forge(language_dir + "segment.js",            "Traditional Chinese Plot Data", ["p = " + plot_data + ";"]);
        } else {
            forge(static_path + "/js/misc/zh_segment.js", "Simplified Chinese Plot Data", ["p = " + plot_data + ";"]);
            forge(language_dir + "segment.js",            "Simplified Chinese Plot Data", ["p = " + plot_data + ";"]);
        }
        fs.unlinkSync(files.plot_data_file);
        
        callback();
    });
}

function start_importaing(trad_file, context, callback)
{
    var check_simp,
        check_trad,
        import_simp = true,
        import_trad = true,
        name_simp = "Simplified Chinese (简体中文)",
        name_trad = "Traditional Chinese (繁體中文)",
        lang_simp = "zh_s",
        lang_trad = "zh_t",
        word_len  = 255,
        notes_len = 1,
        segmentor,
        segment_simp,
        segment_trad,
        trad_text = fs.readFileSync(trad_file, "utf8");
    
    function import_simp_into_db()
    {
        /// Create the segmentor after analyzing all of the data.
        segmentor = require(language_dir + "segment.js");
        
        if (import_simp) {
            segment_simp = segmentor.segment_init("./analysis_simp.js", language_dir + "dict_raw_simp");
            
            console.log("Importing " + name_simp + " into database...");
            import_text(context, create_simplified_version(trad_text), name_simp, lang_simp, segment_simp, word_len, notes_len, function ()
            {
                console.log("Creating verse tables...");
                create_verse_tables(lang_simp, import_trad_into_db);
            });
        } else {
            import_trad_into_db();
        }
    }
    
    function import_trad_into_db()
    {
        if (import_trad) {
            segment_trad = segmentor.segment_init("./analysis_trad.js", language_dir + "dict_raw_trad", true);
            
            console.log("Importing " + name_trad + " into database...");
            import_text(context, trad_text, name_trad, lang_trad, segment_trad, word_len, notes_len, function ()
            {
                console.log("Creating verse tables...");
                create_verse_tables(lang_trad, callback || context.done);
            });
        } else {
            if (callback) {
                callback();
            } else {
                context.done();
            }
        }
    }
    
    function get_simp()
    {
        if (import_simp) {
            console.log("Preparing " + name_simp + "...");
            run_auto_convert("simp", lang_simp, create_simplified_version(trad_text), get_trad);
        } else {
            get_trad();
        }
    }
    
    function get_trad()
    {
        if (import_trad) {
            console.log("Preparing " + name_trad + "...");
            run_auto_convert("trad", lang_trad, trad_text, import_simp_into_db);
        } else {
            import_simp_into_db();
        }
    }
    
    check_simp = function ()
    {
        context.does_bible_table_exist(lang_simp, function (exists)
        {
            if (!exists) {
                check_trad();
            } else {
                context.yes_no("Do you want to overwrite bible_" + lang_simp + "? ", function (overwrite)
                {
                    if (!overwrite) {
                        import_simp = false;
                    }
                    check_trad();
                }, ["red", "bold"]);
            }
        });
    };
    
    check_trad = function ()
    {
        context.does_bible_table_exist(lang_trad, function (exists)
        {
            if (!exists) {
                get_simp();
            } else {
                context.yes_no("Do you want to overwrite bible_" + lang_trad + "? ", function (overwrite)
                {
                    if (!overwrite) {
                        import_trad = false;
                    }
                    get_simp();
                }, ["red", "bold"]);
            }
        });
    };
    
    /// Start by checking if the tables already exist.
    check_simp();
}

exports.start = function (context)
{
    context.yes_no("Download from the internet?", "yes", function (download)
    {
        if (download) {
            context.ask("What is the Traditional Shangdi (上帝) URL?", "http://ckjv.asia/ckjv_shangdi_tc/script/ckjv.js", function (trad_turl)
            {
                var download_filename = "tmp_trad_ckjv_download_" + random_numbers();
                download_file(trad_turl, function ()
                {
                    start_importaing(download_filename, context, function ()
                    {
                        fs.unlinkSync(download_filename);
                        context.done();
                    })
                }, {progress: true, save_as: download_filename});
            });
        } else {
            context.ask("Where is the Traditional Shangdi (上帝) file located?", "../languages/Chinese/ckjv_shangdi_tc/script/ckjv.js", function (trad_file)
            {
                start_importaing(trad_file, context, function ()
                {
                    context.done();
                });
            });
        }
    });
};
